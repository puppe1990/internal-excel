:root {
  --bg: #0b0c10;
  --panel: #151821;
  --muted: #8a93a5;
  --text: #e7eaf0;
  --brand: #6ee7ff;
  --accent: #a3e635;
  --danger: #ef4444;
  --border: #262b36;
  --grid-alt: #0f1220;
}
* { box-sizing: border-box; }
body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: radial-gradient(1200px 800px at 20% -10%, #0b1429 0%, var(--bg) 40%);
  color: var(--text);
}
header {
  position: sticky; top: 0; z-index: 10;
  backdrop-filter: blur(8px);
  background: linear-gradient(180deg, rgba(11,12,16,.8), rgba(11,12,16,.6));
  border-bottom: 1px solid var(--border);
}
.bar {
  display: flex; gap: 8px; align-items: center; padding: 10px 12px; flex-wrap: wrap;
}
.bar h1 { font-size: 16px; margin: 0 8px 0 0; font-weight: 700; color: var(--brand); }
.btn {
  appearance: none; border: 1px solid var(--border); background: var(--panel); color: var(--text);
  padding: 8px 10px; border-radius: 12px; font-weight: 600; cursor: pointer; font-size: 13px;
  transition: transform .05s ease, background .2s ease, border-color .2s ease;
}
.btn:hover { background: #1b2030; border-color: #2d3444; }
.btn:active { transform: translateY(1px); }
.btn.primary { border-color: rgba(110,231,255,.4); box-shadow: inset 0 0 0 1px rgba(110,231,255,.2); }
.btn.danger { border-color: rgba(239,68,68,.35); }
.bar input[type="file"] { display: none; }
.toolbar-spacer { flex: 1 1 auto; }

.wrapper { padding: 16px; }
.sheet {
  overflow: auto; border: 1px solid var(--border); border-radius: 14px;
  box-shadow: 0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03);
  background: linear-gradient(180deg, rgba(15,18,32,.7), rgba(10,12,18,.8));
}

table { border-collapse: separate; border-spacing: 0; width: max-content; min-width: 100%; }
thead th { position: sticky; top: 0; z-index: 5; background: #0f1322; color: var(--muted); font-weight: 700; }
tbody th { position: sticky; left: 0; background: #0f1322; color: var(--muted); font-weight: 700; }
th, td {
  border-right: 1px solid var(--border); border-bottom: 1px solid var(--border);
  min-width: 120px; max-width: 360px; width: 120px; height: 34px; padding: 6px 10px; text-align: left; vertical-align: middle;
}
th.corner { position: sticky; left: 0; top: 0; z-index: 6; width: 46px; min-width: 46px; max-width: 46px; text-align: center; background: #0f1322; }
th.rowhdr { width: 46px; min-width: 46px; max-width: 46px; text-align: center; }

td { background: transparent; }
tbody tr:nth-child(odd) td { background: var(--grid-alt); }

.cell { width: 100%; height: 100%; outline: none; border-radius: 8px; padding: 2px 4px; }
.cell:focus { box-shadow: 0 0 0 2px rgba(110,231,255,.35); background: rgba(110,231,255,.06); }
.bold { font-weight: 700; }

.status {
  padding: 10px 12px; display: flex; gap: 16px; align-items: center; color: var(--muted);
  font-size: 12px;
}
.pill { padding: 4px 8px; border: 1px solid var(--border); border-radius: 999px; }
.kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size: 11px; border: 1px solid var(--border); border-radius: 6px; padding: 2px 6px; }

.sum-highlight { outline: 2px dashed var(--accent); outline-offset: -2px; }
.resizer { position: absolute; right: 0; top: 0; width: 6px; height: 100%; cursor: col-resize; user-select: none; }
th, td { position: relative; }
